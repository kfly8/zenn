---
title: "Perlã®ä»Š"
---

### Perlã®ä»Š

2022å¹´ã€Perl v5.36ã®ãƒªãƒªãƒ¼ã‚¹ä»¥é™ã€Perlæœ¬ä½“ã®é–‹ç™ºãŒã“ã‚Œã¾ã§ã«ãªã„ã»ã©æ´»ç™ºã§ã™ã€‚çµ„ã¿è¾¼ã¿ã®classæ§‹æ–‡ãªã©è¨€èªæ©Ÿèƒ½ã®æ‹¡å¼µãŒå¢—ãˆã¦ã„ã¾ã™ã€‚ã¾ãŸã€åˆå­¦è€…ã‚’æƒ‘ã‚ã™æ©Ÿèƒ½ã‚’äºˆé˜²ã™ã‚‹ä»•çµ„ã¿ã‚‚å°å…¥ã•ã‚Œã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®ç¾ä»£çš„ãªãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’å–ã‚Šå…¥ã‚Œã‚‹é€²åŒ–ã‚’ã—ã¦ã„ã¾ã™ã€‚æœ¬æ›¸ã§ã¯ã“ã®é€²åŒ–ã‚’ã§ãã‚‹ã ã‘ãŠä¼ãˆã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚


TODO: ç”»åƒã«ã—ãŸã„

#### BEFORE

```perl
package Cache::LRU;
use strict;
use warnings;

use Hash::Ordered;

sub new {
    my ($class, %args) = @_;
    my $self = {
        max_size => $args{max_size} // 20,
        _cache   => Hash::Ordered->new(),
    };
    return bless $self, $class;
}

sub set {
    my ($self, $key, $value) = @_;
    if ($self->{_cache}->exists($key)) {
        $self->{_cache}->delete($key);
    } elsif ($self->{_cache}->keys >= $self->{max_size}) {
        $self->{_cache}->shift;
    }
    $self->{_cache}->set($key, $value);
}

sub get {
    my ($self, $key) = @_;
    $self->{_cache}->get($key);
}

1;

my $cache = Cache::LRU->new(max_size => 3);

use feature qw(say);
$cache->set('a', 2);

say $cache->get('a'); # 1
```

#### AFTER

```perl
use v5.42;
use experimental qw(class);

use Hash::Ordered;

class Cache::LRU {
    field $max_size :param = 20;
    field $cache = Hash::Ordered->new();

    method set($key, $value) {
        if ($cache->exists($key)) {
            $cache->delete($key);
        } elsif ($cache->keys >= $max_size) {
            $cache->shift;
        }
        $cache->set($key, $value);
    }

    method get($key) {
        $cache->get($key);
    }
}

my $cache = Cache::LRU->new(max_size => 3);

$cache->set(a => 2);
say $cache->get('a'); # 2
```

ã“ã®å¤‰åŒ–ã®èƒŒæ™¯ã®ä¸€ã¤ã¨ã—ã¦ã€Perlã®æ–‡æ³•æ‹¡å¼µãŒPerlæœ¬ä½“ã‚’å¤‰æ›´ã›ãšã¨ã‚‚å¯èƒ½ã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ã€‚å…·ä½“çš„ã«ã¯ã€PEVANSæ°ã‚‰ã«ã‚ˆã£ã¦ã€2010å¹´(v5.12)ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ•ã‚§ãƒ¼ã‚ºã«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒ•ãƒƒã‚¯ã—ã¦ASTã‚’æ›¸ãæ›ãˆã‚‹keyword pluginãŒå°å…¥ã•ã‚Œã€Perlã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§æ–°æ©Ÿèƒ½ã®æ¤œè¨¼ã‚’è¡Œã„ã€ãã®å¾Œã€Perlæœ¬ä½“ã‚“å–ã‚Šè¾¼ã¾ã‚Œã‚‹ã¨ã„ã†æµã‚ŒãŒç¢ºç«‹ã•ã‚Œã¾ã—ãŸã€‚
ä¾‹ãˆã°ã€çµ„ã¿è¾¼ã¿ã®classæ§‹æ–‡ã¯ã€[Corinna](https://github.com/Perl-Apollo/Corinna)ã§Ovidæ°ã«ã‚ˆã£ã¦ãƒ‡ã‚¶ã‚¤ãƒ³ã•ã‚Œã€PEVANSæ°ã«ã‚ˆã£ã¦[Object::Pad](https://metacpan.org/pod/Object::Pad)ãŒå®Ÿè£…ã€æ¤œè¨¼ã•ã‚Œã€ãã®å¾Œã€Perlæœ¬ä½“ã«å–ã‚Šè¾¼ã¾ã‚Œã¾ã—ãŸã€‚

PEVANSæ°ã¯ã€London Perl Workshop 2016ã«ã¦ã€ã“ã†èªã£ãŸãã†ã§ã™ã€‚

> Perlã‚’ã‚‚ã£ã¨ã‚ˆãã—ã¦ã„ãã«ã¯ã€å…¬é–‹ã•ã‚Œã¦ã„ã‚‹æ©Ÿèƒ½ã‚’ã‚®ãƒªã‚®ãƒªã¾ã§ä½¿ã„å€’ã—ã¦ã€ã§ãã‚‹äººãŸã¡ã«ã€Œãã‚“ãªç„¡èŒ¶ãªã‚„ã‚Šæ–¹ã‚ˆã‚Šã‚‚ã£ã¨ã„ã„æ–¹æ³•ãŒã‚ã‚‹ã€ã¨è¨€ã‚ã›ã‚‹ã¨ã„ã„
> -- https://charsbar.hatenadiary.org/entry/20161217/1481954722 ã‚ˆã‚Šå¼•ç”¨

å®Ÿéš›ã€æ‹™ä½œã®æ–‡æ³•æ‹¡å¼µãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« [Syntax::Keyword::Assert](https://metacpan.org/pod/Syntax::Keyword::Assert) ã‚’æ›¸ã„ãŸéš›ã«ã€PEVANSæ°ã‹ã‚‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ã‚‚ã‚‰ãˆãŸã®ã§ã€ã“ã‚Œã¯æœ¬å½“ã®ã“ã¨ã§ã™ã­ğŸ˜„
